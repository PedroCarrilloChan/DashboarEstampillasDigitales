# El lenguaje que estamos usando
language = "python3"
# El comando que se ejecutará cuando presiones "Run"
# AÑADIMOS "poetry run" para ejecutar el comando dentro del entorno virtual
run = "poetry run uvicorn main:app --host 0.0.0.0 --port 8000"
modules = ["python-3.11"]

# Opcional: Esto le dice a Replit qué paquetes instalar
[deployment]
# También actualizamos aquí para consistencia
run = ["sh", "-c", "poetry run uvicorn main:app --host 0.0.0.0 --port $PORT"]

# Configuración para el gestor de paquetes UPM
[packager]
language = "python3"

[packager.features]
# Habilita el gestor de paquetes Poetry
guess_imports = true
package_search = true

[nix]
packages = ["libxcrypt", "psmisc"]

[[ports]]
localPort = 5000
externalPort = 5000

[[ports]]
localPort = 8000
externalPort = 80

[workflows]
runButton = "Run FastAPI Server"

[[workflows.workflow]]
name = "Run FastAPI Server"
author = 31414810
mode = "sequential"

[[workflows.workflow.tasks]]
task = "shell.exec"
args = "poetry run uvicorn main:app --host 0.0.0.0 --port 5000 --reload"
